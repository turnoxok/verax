<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Informe CEA</title>
</head>
<body>
  <h2>Informe CEA</h2>
  <button onclick="abrirInforme()">Ver mi informe</button>
  <div id="iframeContainer" style="margin-top:20px;"></div>

  <script>
    async function abrirInforme() {
      // 1. Generar token
      const res = await fetch("/.netlify/functions/generateToken");
      const data = await res.json();
      const token = data.token;

      // 2. Crear iframe con openCEA.js + token
      const iframe = document.createElement("iframe");
      iframe.src = `/.netlify/functions/openCEA?token=${token}`;
      iframe.width = "100%";
      iframe.height = "600";
      iframe.style.border = "1px solid #ccc";

      const container = document.getElementById("iframeContainer");
      container.innerHTML = "";
      container.appendChild(iframe);
    }
  </script>
</body>
</html>
